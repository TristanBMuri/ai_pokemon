2025-11-29 10:41:33,779 - Opponent - CRITICAL - Error message received: |nametaken|Opponent|Your authentication token was invalid.
2025-11-29 10:41:33,779 - Opponent - ERROR - Unhandled exception raised while handling message:
|nametaken|Opponent|Your authentication token was invalid.
Traceback (most recent call last):
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/poke_env/ps_client/ps_client.py", line 170, in _handle_message
    raise ShowdownException("Error message received: %s", message)
poke_env.exceptions.ShowdownException: ('Error message received: %s', '|nametaken|Opponent|Your authentication token was invalid.')
2025-11-29 10:41:33,780 - Agent - CRITICAL - Error message received: |nametaken|Agent|Your authentication token was invalid.
2025-11-29 10:41:33,780 - Agent - ERROR - Unhandled exception raised while handling message:
|nametaken|Agent|Your authentication token was invalid.
Traceback (most recent call last):
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/poke_env/ps_client/ps_client.py", line 170, in _handle_message
    raise ShowdownException("Error message received: %s", message)
poke_env.exceptions.ShowdownException: ('Error message received: %s', '|nametaken|Agent|Your authentication token was invalid.')
2025-11-29 10:41:33,780 - BattleEnv yfz45 - CRITICAL - Error message received: |nametaken|BattleEnv yfz45|Your authentication token was invalid.
2025-11-29 10:41:33,780 - BattleEnv yfz45 - ERROR - Unhandled exception raised while handling message:
|nametaken|BattleEnv yfz45|Your authentication token was invalid.
Traceback (most recent call last):
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/poke_env/ps_client/ps_client.py", line 170, in _handle_message
    raise ShowdownException("Error message received: %s", message)
poke_env.exceptions.ShowdownException: ('Error message received: %s', '|nametaken|BattleEnv yfz45|Your authentication token was invalid.')
/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/stable_baselines3/common/on_policy_algorithm.py:150: UserWarning: You are trying to run PPO on the GPU, but it is primarily intended to run on the CPU when not using a CNN policy (you are using ActorCriticPolicy which should be a MlpPolicy). See https://github.com/DLR-RM/stable-baselines3/issues/1245 for more info. You can pass `device='cpu'` or `export CUDA_VISIBLE_DEVICES=` to force using the CPU.Note: The model will train, but the GPU utilization will be poor and the training might take longer than on CPU.
  warnings.warn(
DEBUG: reset called on instance 139966294248144. _challenge_task: None
Observation Space Type: <class 'gymnasium.spaces.box.Box'>
Observation Space: Box(0.0, 1.0, (5,), float32)
DEBUG: Agent type: <class 'poke_env.environment.env._EnvPlayer'>
DEBUG: Agent dir: ['DEFAULT_CHOICE_CHANCE', 'MESSAGES_TO_IGNORE', '__abstractmethods__', '__annotations__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__slots__', '__static_attributes__', '__str__', '__subclasshook__', '__weakref__', '_abc_impl', '_accept_challenges', '_accept_open_team_sheet', '_battle_against', '_battle_count_queue', '_battle_end_condition', '_battle_finished_callback', '_battle_semaphore', '_battle_start_condition', '_battles', '_challenge_queue', '_create_battle', '_env_move', '_format', '_get_battle', '_handle_battle_message', '_handle_battle_request', '_handle_challenge_request', '_ladder', '_max_concurrent_battles', '_save_replays', '_send_challenges', '_start_timer_on_battle_start', '_team', '_trying_again', '_update_challenges', '_waiting', 'accept_challenges', 'accept_open_team_sheet', 'battle', 'battle_against', 'battle_queue', 'battles', 'choose_default_move', 'choose_move', 'choose_random_doubles_move', 'choose_random_move', 'choose_random_singles_move', 'create_order', 'format', 'format_is_doubles', 'ladder', 'logger', 'n_finished_battles', 'n_lost_battles', 'n_tied_battles', 'n_won_battles', 'next_team', 'order_queue', 'ps_client', 'random_teampreview', 'reset_battles', 'send_challenges', 'teampreview', 'update_team', 'username', 'win_rate']
DEBUG: Agent ps_client: <poke_env.ps_client.ps_client.PSClient object at 0x7f4c71400910>
DEBUG: Agent ps_client dir: ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__weakref__', '_account_configuration', '_active_tasks', '_avatar', '_create_logger', '_handle_battle_message', '_handle_challenge_request', '_handle_message', '_listening_coroutine', '_logged_in', '_logger', '_open_timeout', '_ping_interval', '_ping_timeout', '_sending_lock', '_server_configuration', '_stop_listening', '_update_challenges', 'accept_challenge', 'account_configuration', 'challenge', 'change_avatar', 'listen', 'log_in', 'logged_in', 'logger', 'search_ladder_game', 'send_message', 'server_configuration', 'set_team', 'stop_listening', 'username', 'wait_for_login', 'websocket', 'websocket_url']
Warning: Could not find agent loop to start challenge.
Using cuda device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Starting training...
Training finished!
Traceback (most recent call last):
  File "/home/tristan/CodingProjects/ai_pokemon/train_battler.py", line 85, in <module>
    train()
    ~~~~~^^
  File "/home/tristan/CodingProjects/ai_pokemon/train_battler.py", line 76, in train
    model.learn(total_timesteps=10000)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
           ~~~~~~~~~~~~~^
        total_timesteps=total_timesteps,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        progress_bar=progress_bar,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 311, in learn
    total_timesteps, callback = self._setup_learn(
                                ~~~~~~~~~~~~~~~~~^
        total_timesteps,
        ^^^^^^^^^^^^^^^^
    ...<3 lines>...
        progress_bar,
        ^^^^^^^^^^^^^
    )
    ^
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
                     ~~~~~~~~~~~~~~^^
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 78, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/poke_env/environment/single_agent_wrapper.py", line 44, in reset
    obs, infos = self.env.reset(seed, options)
                 ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/home/tristan/CodingProjects/ai_pokemon/nuzlocke_gauntlet_rl/envs/battle_env.py", line 43, in reset
    return super().reset(seed=seed, options=options)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tristan/CodingProjects/ai_pokemon/.venv/lib/python3.13/site-packages/poke_env/environment/env.py", line 334, in reset
    raise RuntimeError("Agent is not challenging")
RuntimeError: Agent is not challenging
